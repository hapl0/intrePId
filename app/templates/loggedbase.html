<!DOCTYPE html>
<html lang="en">
	<head>
		<title>IntrePId</title>
		<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
		<link href="/static/css/bootstrap.min.css" rel="stylesheet" media="screen">
		<link href="/static/css/bootstrap-responsive.css" rel="stylesheet">
		<link href="/static/css/jasny-bootstrap.css" rel="stylesheet">
		<script src="/static/js/jquery-latest.js"></script>
		<!-- Téléchargé jquery pour faciliter l'accès au site en local (pas de dépendance à un autre site) -->
		<script src="/static/js/bootstrap.min.js"></script>
		<script src="/static/js/jasny-bootstrap.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<style type="text/css">
			.pull-right .dropdown-menu:after {
			    left: auto;
			    right: 13px;
			}
			.pull-right .dropdown-menu {
			    left: auto;
			    right: 0;
			}
		</style>

		<script type="text/javascript">
		// Custom query to get the current values of cpu/ram/disk
		function update_values() {
			$SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
			$.getJSON($SCRIPT_ROOT+"/_stuff",
				function(data) {
					$("#cpuload").text(data.cpu+" %")
					$("#ram").text(data.ram+" %")
					$("#disk").text(data.disk+" %")
				});
		}	
		// Updates values according to user's preferences
		setInterval(update_values,{{ settings.updatetime }})
		window.onload= function() {
			$("#logout").tooltip();
		}
		// Removes the alerts after 5s
		window.setTimeout(function() {
    		$(".alert").fadeTo(500, 0).slideUp(500, function(){
      		$(this).remove(); 
    		});
			}, 5000);
		</script>
		{% block js%}{% endblock %}

	</head>
	<style> body { padding-top: 60px; } </style>
	<body>
		{% block header %}
		<div class="navbar navbar-inverse navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container-fluid">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="/index"><font size="6">intre</font><font color="red" size="10">π</font><font size="6">d</font></a>
					<div class="nav-collapse collapse">

					<ul id="topbar" class="nav pull-right">
						<p></p>
						<p></p>
						<li><img src="/static/img/DefaultIcon/png/32x32/cpu.png"></li>
						<li>&nbsp;</li>
						<li><font id ="cpuload" color="white"><img src="/static/img/loading.gif" alt="loading"></font><br /><font color="#C0C0C0">CPU</font></li>
						<li>&nbsp;&nbsp;&nbsp;</li>
						<li><img src="/static/img/DefaultIcon/png/32x32/ram.png"></li>
						<li>&nbsp;</li>
						<li><font id ="ram" color="white"><img src="/static/img/loading.gif" alt="loading"></font><br /><font color="#C0C0C0">RAM</font></li>
						<li>&nbsp;&nbsp;&nbsp;</li>						
						<li><img src="/static/img/DefaultIcon/png/32x32/floppy.png"></li>
						<li>&nbsp;</li>
						<li><font id ="disk" color="white"><img src="/static/img/loading.gif" alt="loading"></font><br /><font color="#C0C0C0">Disk</font></li>
						<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
						<li><div><a class="btn btn-small btn-danger" href="/logout" id="logout" data-toggle="tooltip" data-placement="bottom" title data-original-title="Logout"><i class="icon-off icon-white"></i></a></div></li>
					</ul>
					<ul class="nav">
						<p></p>
						<p></p>
						<li><p class="navbar-text">intrepid [ɪnˈtrɛpɪd]. adj. fearless; daring;</p></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	{% endblock %}
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span2 bs-docs-sidebar" style="padding-right:20px; border-right: 1px solid #ccc;">

				
					<ul class="nav nav-pills nav-stacked">
						{% block menu %}
						{% set active_page = active_page|default('index') -%}

						

						<li{% if active_page == 'index' %} class="active"{% endif %}><a href="/index"><img src="/static/img/DefaultIcon/png/16x16/home.png"> Home</a></li>
						
						<li{% if active_page == 'settings' %} class="active"{% endif %}><a href="/settings"><img src="/static/img/DefaultIcon/png/16x16/preferences.png"> Settings</a></li>
						

						<li{% if active_page == 'scenarios' %} class="active"{% endif %}><a href="/scenarios"><img src="/static/img/DefaultIcon/png/16x16/search.png"> Scenarios</a></li>
						{% with ips = ips %}
							{% if ips.includedip %}
							<li{% if active_page == 'type' %} class="active"{% endif %}><a href="/scenarios/type">&nbsp&nbsp<img src="/static/img/DefaultIcon/png/16x16/search.png"> Type</a></li>
							
							<li{% if active_page == 'manager' %} class="active"{% endif %}><a href="/scenarios/manager">&nbsp&nbsp<img src="/static/img/DefaultIcon/png/16x16/search.png"> Manager</a></li>
							{% else %}	
							
							<li class="disabled"><a href="/scenarios/type">&nbsp&nbsp<img src="/static/img/DefaultIcon/png/16x16/search.png"> Type</a></li>
							
							<li class="disabled"><a href="/scenarios/manager">&nbsp&nbsp<img src="/static/img/DefaultIcon/png/16x16/search.png"> Manager</a></li>
							{% endif %}
						{% endwith %}


						<li{% if active_page == 'updates' %} class="active"{% endif %}><a href="/updates"><img src="/static/img/DefaultIcon/png/16x16/key-shift.png"> Updates</a></li>
						
						<li{% if active_page == 'term' %} class="active"{% endif %}><a href="/term"><img src="/static/img/DefaultIcon/png/16x16/terminal.png"> Terminal</a></li>
						{% endblock %}
					</ul>
					

					{% with errors = get_flashed_messages(category_filter=["error"]) %}
                    {% if errors %}
                        <div class="alert alert-error">
						    {% for message in errors %}
						        {{message}}<br />
						    {% endfor %}
					    </div>						        
					{% endif %}
					{% endwith %}

					{% with infos = get_flashed_messages(category_filter=["info"]) %}
                    {% if infos %}
                        <div class="alert alert-success">
						    {% for message in infos %}
						        {{message}}<br />
						    {% endfor %}
					    </div>						        
					{% endif %}
					{% endwith %}
				
				</div>
				<div class="span10">
					<div class="clearfix content-heading">
						{% block content %}{% endblock %}
					</div>
				</div>
			</div>
		</div>
		<script>
		window.onload= function() {
			update_values();
		}
		</script>
	</body>
</html>